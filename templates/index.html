<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>CalcMaster Pro - 100+ Professional Calculators</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
      /* Enhanced inline styles for better theme */
      body { 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        margin:0; padding:0; min-height:100vh;
      }
      .container { 
        max-width:1200px; margin:0 auto; background:#fff; 
        border-radius:20px; box-shadow:0 20px 60px rgba(0,0,0,0.3); 
        overflow:hidden; margin:20px;
      }
      
      /* Header Styles */
      .header-top { 
        display:flex; justify-content:space-between; align-items:center; 
        padding:20px 40px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        color:white;
      }
      .logo h1 { 
        margin:0; font-size:2.2em; text-shadow:2px 2px 4px rgba(0,0,0,0.3); 
      }
      .tagline { 
        font-size:0.9em; opacity:0.9; display:block; margin-top:5px; 
      }
      .top-nav { 
        display:flex; gap:15px; 
      }
      .nav-btn { 
        color:white; text-decoration:none; padding:10px 20px; 
        border-radius:25px; transition:all 0.3s; background:rgba(255,255,255,0.1); 
        border:2px solid transparent;
      }
      .nav-btn:hover, .nav-btn.active { 
        background:rgba(255,255,255,0.2); border-color:rgba(255,255,255,0.3); 
        transform:translateY(-2px);
      }
      
      /* Hero Banner */
      .hero-banner { 
        text-align:center; padding:40px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        color:white; border-bottom:5px solid rgba(255,255,255,0.1);
      }
      .hero-banner h2 { 
        font-size:2.5em; margin:0 0 15px 0; text-shadow:2px 2px 4px rgba(0,0,0,0.3); 
      }
      .hero-banner p { 
        font-size:1.2em; margin:0 0 30px 0; opacity:0.9; 
      }
      .feature-badges { 
        display:flex; justify-content:center; gap:20px; flex-wrap:wrap; 
      }
      .badge { 
        background:rgba(255,255,255,0.2); padding:8px 16px; border-radius:20px; 
        font-size:0.9em; border:1px solid rgba(255,255,255,0.3);
      }
      
      /* Main Section */
      .main-section { 
        padding:30px 40px; 
      }
      .search-container { 
        margin-bottom:25px; 
      }
      .search-box { 
        width:100%; padding:15px 20px; font-size:1.1em; border:2px solid #ddd; 
        border-radius:50px; outline:none; transition:all 0.3s; box-shadow:0 2px 10px rgba(0,0,0,0.1);
      }
      .search-box:focus { 
        border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1); 
      }
      
      /* Category Filter */
      .category-filter { 
        display:flex; flex-wrap:wrap; gap:10px; margin-bottom:20px; 
      }
      .category-button { 
        padding:8px 16px; border-radius:20px; border:2px solid #ddd; 
        background:#fff; cursor:pointer; transition:all 0.3s; font-size:0.9em;
      }
      .category-button:hover { 
        border-color:#667eea; color:#667eea; transform:translateY(-2px); 
      }
      .category-button.active { 
        background:#667eea; color:#fff; border-color:#667eea; 
      }
      
      /* Calculator Grid */
      .calculator-grid { 
        display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); 
        gap:20px; margin-top:20px; 
      }
      .calculator-card { 
        background:#fff; border:2px solid #e9ecef; border-radius:15px; 
        padding:20px; cursor:pointer; transition:all 0.3s; 
        box-shadow:0 2px 10px rgba(0,0,0,0.05);
      }
      .calculator-card:hover { 
        transform:translateY(-5px); box-shadow:0 10px 30px rgba(102,126,234,0.2); 
        border-color:#667eea; 
      }
      .calculator-card h3 { 
        color:#667eea; margin:0 0 8px 0; font-size:1.2em; 
      }
      .calculator-card .category { 
        display:inline-block; background:#f0f0f0; padding:4px 12px; 
        border-radius:20px; font-size:0.85em; color:#666; margin-bottom:10px; 
      }
      .calculator-card .description { 
        color:#666; font-size:0.9em; line-height:1.4; margin:0; 
      }
      
      /* Form Container */
      .calculator-form-container { 
        display:none; padding:30px 0; 
      }
      .calculator-form-container.active { 
        display:block; 
      }
      .back-button { 
        margin-bottom:20px; padding:12px 24px; border-radius:10px; 
        border:2px solid #667eea; background:#1a1a2e; color:#fff; 
        cursor:pointer; font-weight:600; font-size:1.1em; transition:all 0.3s;
        box-shadow:0 4px 12px rgba(102,126,234,0.3);
      }
      .back-button:hover { 
        background:#667eea; transform:translateX(-5px); 
        box-shadow:0 6px 16px rgba(102,126,234,0.5); 
      }
      
      /* Calculator Form */
      .calculator-form { 
        background:#fff; padding:30px; border-radius:15px; 
        box-shadow:0 5px 15px rgba(0,0,0,0.1); max-width:600px; margin:0 auto; 
      }
      .form-group { 
        margin-bottom:20px; 
      }
      .form-group label { 
        display:block; margin-bottom:8px; color:#333; font-weight:600; 
      }
      .form-group input, .form-group select, .form-group textarea { 
        width:100%; padding:12px; border:2px solid #ddd; border-radius:8px; 
        font-size:1em; transition:all 0.3s; 
      }
      .form-group input:focus, .form-group select:focus, .form-group textarea:focus { 
        outline:none; border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1); 
      }
      .submit-button { 
        background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        color:white; border:none; padding:15px 40px; border-radius:25px; 
        font-size:1.1em; cursor:pointer; transition:all 0.3s; width:100%; 
        font-weight:600; 
      }
      .submit-button:hover { 
        transform:translateY(-2px); box-shadow:0 5px 20px rgba(102,126,234,0.4); 
      }
      
      /* Result Display */
      .result { 
        margin-top:25px; padding:25px; background:#1a1a2e; color:#fff; 
        border-radius:12px; border:3px solid #667eea; font-size:1.3em; 
        text-align:center; font-weight:700; display:none; 
        box-shadow:0 6px 20px rgba(102,126,234,0.4); letter-spacing:0.5px; 
      }
      .result.show { 
        display:block; animation:slideIn 0.3s ease-out; 
      }
      
      /* Modal Styles */
      .modal { 
        display:none; position:fixed; z-index:1000; left:0; top:0; 
        width:100%; height:100%; background:rgba(0,0,0,0.5); 
      }
      .modal-content { 
        background:#fff; margin:5% auto; padding:30px; width:80%; 
        max-width:800px; border-radius:15px; position:relative; 
        max-height:80vh; overflow-y:auto;
      }
      .close { 
        position:absolute; right:20px; top:15px; font-size:28px; 
        font-weight:bold; cursor:pointer; color:#aaa; 
      }
      .close:hover { 
        color:#000; 
      }
      
      /* Stats and No Results */
      .stats { 
        text-align:center; padding:15px; color:#666; font-size:0.9em; 
        background:#f8f9fa; border-radius:10px; margin-bottom:20px; 
      }
      .no-results { 
        display:none; text-align:center; padding:40px; color:#666; 
        font-size:1.2em; 
      }
      .no-results.show { 
        display:block; 
      }
      
      /* Animations */
      @keyframes slideIn { 
        from { opacity:0; transform:translateY(-10px); } 
        to { opacity:1; transform:translateY(0); } 
      }
      
      /* Mobile Responsive */
      @media (max-width: 768px) {
        .container { margin:10px; }
        .header-top { flex-direction:column; gap:15px; padding:20px; }
        .top-nav { justify-content:center; }
        .hero-banner { padding:30px 20px; }
        .hero-banner h2 { font-size:2em; }
        .feature-badges { flex-direction:column; align-items:center; }
        .main-section { padding:20px; }
        .calculator-grid { grid-template-columns:1fr; }
        .modal-content { width:95%; margin:10% auto; padding:20px; }
      }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="logo">
                    <h1>üßÆ CalcMaster Pro</h1>
                    <span class="tagline">Your Ultimate Calculation Companion</span>
                </div>
                <nav class="top-nav">
                    <a href="#" class="nav-btn active" onclick="showHome()">üè† Calculators</a>
                    <a href="#" class="nav-btn" onclick="showAbout()">‚ÑπÔ∏è About</a>
                    <a href="#" class="nav-btn" onclick="showContact()">üìû Contact</a>
                    <a href="#" class="nav-btn" onclick="showFeedback()">‚≠ê Feedback</a>
                </nav>
            </div>
            <div class="hero-banner">
                <h2>üöÄ 100+ Professional Calculators</h2>
                <p>Mathematics ‚Ä¢ Finance ‚Ä¢ Physics ‚Ä¢ Health ‚Ä¢ Engineering & More</p>
                <div class="feature-badges">
                    <span class="badge">‚ú® Instant Results</span>
                    <span class="badge">üîí Secure & Private</span>
                    <span class="badge">üì± Mobile Friendly</span>
                </div>
            </div>
        </header>

        <!-- Main Calculator Section -->
        <div id="calculator-section" class="main-section">
            <div class="search-container">
                <input type="text" class="search-box" id="searchBox" placeholder="üîç Search for any calculator... (e.g., age, BMI, interest, area)">
            </div>

            <div class="category-filter" id="categoryFilter"></div>

            <div class="stats" id="stats">Showing all calculators</div>

            <div class="calculator-grid" id="calculatorGrid">
                {% for calc in calculators %}
                <div class="calculator-card" 
                    data-id="{{ calc.id }}" 
                    data-category="{{ calc.category }}" 
                    data-name="{{ calc.name|lower }}" 
                    data-description="{{ calc.description|lower }}">
                    
                    <h3>{{ calc.name }}</h3>
                    <span class="category">{{ calc.category }}</span>
                    <p class="description">{{ calc.description }}</p>
                </div>
                {% endfor %}
            </div>

            <div class="no-results" id="noResults">
                <p>üîç No calculators found matching your search.</p>
                <p>Try different keywords or browse our categories above.</p>
            </div>

            <div class="calculator-form-container" id="calculatorFormContainer">
                <button class="back-button" onclick="showGrid()">‚Üê Back to Calculators</button>
                <div class="calculator-form" id="calculatorForm"></div>
            </div>
        </div>

        <!-- About Modal -->
        <div id="about-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('about-modal')">&times;</span>
                <h2>üöÄ About CalcMaster Pro</h2>
                <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; margin-top:20px;">
                    <div style="background:#f8f9fa; padding:20px; border-radius:10px; border-left:4px solid #667eea;">
                        <h3>üéØ Our Mission</h3>
                        <p>To provide the most comprehensive, accurate, and user-friendly calculator suite on the web. We believe everyone deserves access to powerful calculation tools.</p>
                    </div>
                    <div style="background:#f8f9fa; padding:20px; border-radius:10px; border-left:4px solid #667eea;">
                        <h3>‚ö° Why Choose Us?</h3>
                        <ul style="margin:0; padding-left:20px;">
                            <li>‚úÖ 100+ Professional Calculators</li>
                            <li>‚úÖ Lightning Fast Results</li>
                            <li>‚úÖ Mobile Optimized</li>
                            <li>‚úÖ Completely Free</li>
                            <li>‚úÖ No Registration Required</li>
                        </ul>
                    </div>
                    <div style="background:#f8f9fa; padding:20px; border-radius:10px; border-left:4px solid #667eea;">
                        <h3>üèÜ Trusted by Professionals</h3>
                        <p>Engineers, students, financial advisors, and millions of users worldwide trust CalcMaster Pro for their daily calculations.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Modal -->
        <div id="contact-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('contact-modal')">&times;</span>
                <h2>üìû Get in Touch</h2>
                <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; margin:20px 0;">
                    <div style="text-align:center; padding:20px; background:#f8f9fa; border-radius:10px;">
                        <h3>üìß Email Support</h3>
                        <p style="color:#667eea; font-weight:600;">himeshm548@gmail.com</p>
                        <small>Response within 24 hours</small>
                    </div>
                    <div style="text-align:center; padding:20px; background:#f8f9fa; border-radius:10px;">
                        <h3>üí¨ Live Chat</h3>
                        <p style="color:#667eea; font-weight:600;">Available 9 AM - 6 PM EST</p>
                        <small>Monday to Friday</small>
                    </div>
                    <div style="text-align:center; padding:20px; background:#f8f9fa; border-radius:10px;">
                        <h3>üåê Social Media</h3>
                        <p style="color:#667eea; font-weight:600;">Follow @CalcMasterPro</p>
                        <small>Latest updates & tips</small>
                    </div>
                </div>
                <div style="background:#f8f9fa; padding:20px; border-radius:10px; margin-top:20px;">
                    <h3>Quick Message</h3>
                    <form onsubmit="sendMessage(event)" style="display:flex; flex-direction:column; gap:15px;">
                        <input type="text" placeholder="Your Name" required style="padding:10px; border:2px solid #ddd; border-radius:5px;">
                        <input type="email" placeholder="Your Email" required style="padding:10px; border:2px solid #ddd; border-radius:5px;">
                        <textarea placeholder="Your Message" rows="4" required style="padding:10px; border:2px solid #ddd; border-radius:5px; resize:vertical;"></textarea>
                        <button type="submit" class="submit-button">Send Message</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Feedback Modal -->
        <div id="feedback-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('feedback-modal')">&times;</span>
                <h2>‚≠ê Your Feedback Matters</h2>
                <p style="text-align:center; color:#666; margin-bottom:30px;">Help us improve CalcMaster Pro with your valuable feedback!</p>
                
                <form onsubmit="sendFeedback(event)" style="display:flex; flex-direction:column; gap:20px;">
                    <div style="text-align:center;">
                        <label style="display:block; margin-bottom:10px; font-weight:600;">Rate Your Experience:</label>
                        <div class="rating-stars" id="feedbackRating" style="display:flex; justify-content:center; gap:5px; margin-bottom:20px;">
                            <span class="star" data-rating="1" onclick="setRating(1)" style="font-size:2em; cursor:pointer; color:#ddd;">‚≠ê</span>
                            <span class="star" data-rating="2" onclick="setRating(2)" style="font-size:2em; cursor:pointer; color:#ddd;">‚≠ê</span>
                            <span class="star" data-rating="3" onclick="setRating(3)" style="font-size:2em; cursor:pointer; color:#ddd;">‚≠ê</span>
                            <span class="star" data-rating="4" onclick="setRating(4)" style="font-size:2em; cursor:pointer; color:#ddd;">‚≠ê</span>
                            <span class="star" data-rating="5" onclick="setRating(5)" style="font-size:2em; cursor:pointer; color:#ddd;">‚≠ê</span>
                        </div>
                    </div>
                    
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <input type="text" id="feedbackName" placeholder="Your Name (Optional)" style="padding:10px; border:2px solid #ddd; border-radius:5px;">
                        <input type="email" id="feedbackEmail" placeholder="Your Email (Optional)" style="padding:10px; border:2px solid #ddd; border-radius:5px;">
                    </div>
                    
                    <select id="feedbackType" required style="padding:10px; border:2px solid #ddd; border-radius:5px;">
                        <option value="">Select Feedback Type</option>
                        <option value="compliment">Compliment</option>
                        <option value="suggestion">Suggestion</option>
                        <option value="bug">Bug Report</option>
                        <option value="feature">Feature Request</option>
                        <option value="usability">Usability Issue</option>
                        <option value="other">Other</option>
                    </select>
                    
                    <textarea id="feedbackMessage" placeholder="Share your thoughts, suggestions, or report any issues..." rows="5" required style="padding:10px; border:2px solid #ddd; border-radius:5px; resize:vertical;"></textarea>
                    
                    <label style="display:flex; align-items:center; gap:10px;">
                        <input type="checkbox" id="feedbackUpdates">
                        I'd like to receive updates about new calculators and features
                    </label>
                    
                    <button type="submit" class="submit-button">Submit Feedback</button>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>CalcMaster Pro</h4>
                    <p>Your trusted partner for all calculation needs. Professional, accurate, and always free.</p>
                    <div class="social-links">
                        <a href="#" class="social-link">üìò Facebook</a>
                        <a href="#" class="social-link">üê¶ Twitter</a>
                        <a href="#" class="social-link">üíº LinkedIn</a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#" onclick="showHome()">All Calculators</a></li>
                        <li><a href="#" onclick="showAbout()">About Us</a></li>
                        <li><a href="#" onclick="showContact()">Contact</a></li>
                        <li><a href="#" onclick="alert('Privacy: We respect your privacy and do not collect personal data.')">Privacy Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Popular Categories</h4>
                    <ul class="footer-links">
                        <li><a href="#" onclick="filterByCategory('Finance')">Finance</a></li>
                        <li><a href="#" onclick="filterByCategory('Math')">Mathematics</a></li>
                        <li><a href="#" onclick="filterByCategory('Physics')">Physics</a></li>
                        <li><a href="#" onclick="filterByCategory('Health')">Health</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul class="footer-links">
                        <li><a href="mailto:support@calcmaster.pro">Email Support</a></li>
                        <li><a href="#" onclick="showContact()">Report Bug</a></li>
                        <li><a href="#" onclick="showContact()">Feature Request</a></li>
                        <li><a href="#" onclick="alert('Help: Use the search box to find calculators quickly, or browse by category.')">Help Center</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 CalcMaster Pro. All rights reserved. | Made with ‚ù§Ô∏è for calculation enthusiasts worldwide.</p>
            </div>
        </footer>
    </div>

<script>
    // calculators provided from Flask
    const calculators = {{ calculators|tojson }};
    let currentCalcId = null;
    let activeCategory = 'all';

    // ---------- Build category buttons ----------
    const categories = [...new Set(calculators.map(c => c.category || 'Other'))];
    const categoryFilter = document.getElementById('categoryFilter');

    // "All" button first
    const allBtn = document.createElement('button');
    allBtn.className = 'category-button active';
    allBtn.textContent = 'All';
    allBtn.addEventListener('click', (e) => filterByCategory('all', e));
    categoryFilter.appendChild(allBtn);

    categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'category-button';
        btn.textContent = cat;
        btn.addEventListener('click', (e) => filterByCategory(cat, e));
        categoryFilter.appendChild(btn);
    });

    // ---------- Search functionality ----------
    document.getElementById('searchBox').addEventListener('input', (e) => {
        filterCalculators(e.target.value.toLowerCase(), activeCategory);
    });

    function filterByCategory(category, event) {
        activeCategory = category;
        document.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active'));
        if (event && event.currentTarget) event.currentTarget.classList.add('active');
        filterCalculators(document.getElementById('searchBox').value.toLowerCase(), category);
    }

    function filterCalculators(query, category) {
        const cards = document.querySelectorAll('.calculator-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const name = card.dataset.name || '';
            const desc = card.dataset.description || '';
            const cardCategory = card.dataset.category || '';

            const matchSearch = !query || name.includes(query) || desc.includes(query);
            const matchCategory = category === 'all' || cardCategory === category;

            if (matchSearch && matchCategory) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        document.getElementById('noResults').classList.toggle('show', visibleCount === 0);
        document.getElementById('stats').textContent = `Showing ${visibleCount} calculator${visibleCount !== 1 ? 's' : ''}`;
    }

    // ---------- Calculator card clicks ----------
    document.getElementById('calculatorGrid').addEventListener('click', function(e) {
        const card = e.target.closest('.calculator-card');
        if (card) {
            showCalculator(card.dataset.id);
        }
    });

    function showCalculator(calcId) {
        currentCalcId = calcId;
        const calc = calculators.find(c => c.id === calcId);
        if (!calc) return;

        document.getElementById('calculatorGrid').style.display = 'none';
        document.getElementById('calculatorFormContainer').classList.add('active');
        generateForm(calc);
    }

    function showGrid() {
        document.getElementById('calculatorGrid').style.display = 'grid';
        document.getElementById('calculatorFormContainer').classList.remove('active');
        document.getElementById('calculatorForm').innerHTML = '';
        currentCalcId = null;
    }

    // ---------- Navigation functions ----------
    function showHome() {
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector('[onclick="showHome()"]').classList.add('active');
        showGrid();
    }

    function showAbout() {
        document.getElementById('about-modal').style.display = 'block';
    }

    function showContact() {
        document.getElementById('contact-modal').style.display = 'block';
    }

    function showFeedback() {
        document.getElementById('feedback-modal').style.display = 'block';
    }

    let selectedRating = 0;
    
    function setRating(rating) {
        selectedRating = rating;
        const stars = document.querySelectorAll('.star');
        stars.forEach((star, index) => {
            if (index < rating) {
                star.style.color = '#ffd700';
            } else {
                star.style.color = '#ddd';
            }
        });
    }

    function sendFeedback(event) {
        event.preventDefault();
        
        if (selectedRating === 0) {
            alert('Please select a rating before submitting feedback.');
            return;
        }
        
        const form = event.target;
        const data = {
            name: document.getElementById('feedbackName').value || 'Anonymous',
            email: document.getElementById('feedbackEmail').value || 'No email provided',
            rating: selectedRating,
            type: document.getElementById('feedbackType').value,
            message: document.getElementById('feedbackMessage').value,
            updates: document.getElementById('feedbackUpdates').checked
        };
        
        // Show loading
        const submitBtn = form.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Submitting...';
        submitBtn.disabled = true;
        
        fetch('/feedback', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                alert('‚úÖ Thank you for your feedback! It has been sent to himeshm548@gmail.com. We appreciate your input!');
                form.reset();
                selectedRating = 0;
                setRating(0);
                closeModal('feedback-modal');
            } else {
                alert('Error: ' + result.message);
            }
        })
        .catch(error => {
            alert('Error submitting feedback. Please try again.');
            console.error('Error:', error);
        })
        .finally(() => {
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        });
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }

    function sendMessage(event) {
        event.preventDefault();
        
        const form = event.target;
        const formData = new FormData(form);
        const data = {
            name: form.querySelector('input[type="text"]').value,
            email: form.querySelector('input[type="email"]').value,
            subject: 'Quick Contact',
            message: form.querySelector('textarea').value
        };
        
        // Show loading
        const submitBtn = form.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Sending...';
        submitBtn.disabled = true;
        
        fetch('/contact', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                alert('‚úÖ Thank you! Your message has been sent to himeshm548@gmail.com. We\'ll get back to you within 24 hours.');
                form.reset();
                closeModal('contact-modal');
            } else {
                alert('Error: ' + result.message);
            }
        })
        .catch(error => {
            alert('Error sending message. Please try again.');
            console.error('Error:', error);
        })
        .finally(() => {
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        });
    }

    // Close modals when clicking outside
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = 'none';
        }
    }

    // ---------- Form generation (keeping existing logic) ----------
    function generateForm(calc) {
        const container = document.getElementById('calculatorForm');
        const calcId = calc.id;

        let html = `
            <h2>${escapeHtml(calc.name)}</h2>
            <p style="color:#666;margin-bottom:20px;">${escapeHtml(calc.description)}</p>
            <form id="dynamicForm">
        `;

        // Add all the existing form logic here (keeping it the same)
        if (calcId === 'age') {
            html += `
                <div class="form-group">
                    <label>Date of Birth:</label>
                    <input type="date" id="dob" required>
                </div>
            `;
        } else if (calcId === 'days_between') {
            html += `
                <div class="form-group">
                    <label>Start Date:</label>
                    <input type="date" id="date1" required>
                </div>
                <div class="form-group">
                    <label>End Date:</label>
                    <input type="date" id="date2" required>
                </div>
            `;
        } else if (calcId === 'bmi') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
            `;
        } else if (calcId === 'simple_interest') {
            html += `
                <div class="form-group">
                    <label>Principal Amount ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time (years):</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'tip_calculator') {
            html += `
                <div class="form-group">
                    <label>Bill Amount ($):</label>
                    <input type="number" id="bill" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Tip Percentage (%):</label>
                    <input type="number" id="tip" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'area_circle') {
            html += `
                <div class="form-group">
                    <label>Radius:</label>
                    <input type="number" id="radius" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'percentage') {
            html += `
                <div class="form-group">
                    <label>Value:</label>
                    <input type="number" id="value" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Percentage:</label>
                    <input type="number" id="percent" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'factorial') {
            html += `
                <div class="form-group">
                    <label>Number:</label>
                    <input type="number" id="n" min="0" max="170" required>
                </div>
            `;
        } else if (calcId === 'speed') {
            html += `
                <div class="form-group">
                    <label>Distance:</label>
                    <input type="number" id="distance" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time:</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'unit_temperature') {
            html += `
                <div class="form-group">
                    <label>Temperature:</label>
                    <input type="number" id="temp" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>From:</label>
                    <select id="from" required>
                        <option value="celsius">Celsius</option>
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="kelvin">Kelvin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>To:</label>
                    <select id="to" required>
                        <option value="celsius">Celsius</option>
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="kelvin">Kelvin</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'compound_interest') {
            html += `
                <div class="form-group">
                    <label>Principal Amount ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time (years):</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Compounds per year:</label>
                    <input type="number" id="compounds" value="12" required>
                </div>
            `;
        } else if (calcId === 'loan_payment') {
            html += `
                <div class="form-group">
                    <label>Loan Amount ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Annual Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Loan Term (months):</label>
                    <input type="number" id="months" required>
                </div>
            `;
        } else if (calcId === 'area_rectangle') {
            html += `
                <div class="form-group">
                    <label>Length:</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width:</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'area_triangle') {
            html += `
                <div class="form-group">
                    <label>Base:</label>
                    <input type="number" id="base" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height:</label>
                    <input type="number" id="height" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'volume_sphere') {
            html += `
                <div class="form-group">
                    <label>Radius:</label>
                    <input type="number" id="radius" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'pythagorean') {
            html += `
                <div class="form-group">
                    <label>Side A (leave empty to calculate):</label>
                    <input type="number" id="a" step="0.01">
                </div>
                <div class="form-group">
                    <label>Side B (leave empty to calculate):</label>
                    <input type="number" id="b" step="0.01">
                </div>
                <div class="form-group">
                    <label>Hypotenuse C (leave empty to calculate):</label>
                    <input type="number" id="c" step="0.01">
                </div>
            `;
        } else if (calcId === 'discount') {
            html += `
                <div class="form-group">
                    <label>Original Price ($):</label>
                    <input type="number" id="original" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Discount Percentage (%):</label>
                    <input type="number" id="discount" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'bmr') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Age:</label>
                    <input type="number" id="age" required>
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'gpa') {
            html += `
                <div class="form-group">
                    <label>Total Grade Points:</label>
                    <input type="number" id="points" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Total Credit Hours:</label>
                    <input type="number" id="credits" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'force') {
            html += `
                <div class="form-group">
                    <label>Mass (kg):</label>
                    <input type="number" id="mass" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Acceleration (m/s¬≤):</label>
                    <input type="number" id="acceleration" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'kinetic_energy') {
            html += `
                <div class="form-group">
                    <label>Mass (kg):</label>
                    <input type="number" id="mass" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Velocity (m/s):</label>
                    <input type="number" id="velocity" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'gcd') {
            html += `
                <div class="form-group">
                    <label>Number A:</label>
                    <input type="number" id="a" required>
                </div>
                <div class="form-group">
                    <label>Number B:</label>
                    <input type="number" id="b" required>
                </div>
            `;
        } else if (calcId === 'lcm') {
            html += `
                <div class="form-group">
                    <label>Number A:</label>
                    <input type="number" id="a" required>
                </div>
                <div class="form-group">
                    <label>Number B:</label>
                    <input type="number" id="b" required>
                </div>
            `;
        } else if (calcId === 'mean') {
            html += `
                <div class="form-group">
                    <label>Numbers (comma-separated):</label>
                    <input type="text" id="numbers" required>
                </div>
            `;
        } else if (calcId === 'fuel_efficiency') {
            html += `
                <div class="form-group">
                    <label>Distance (miles):</label>
                    <input type="number" id="distance" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Fuel Used (gallons):</label>
                    <input type="number" id="fuel" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'binary') {
            html += `
                <div class="form-group">
                    <label>Decimal Number:</label>
                    <input type="number" id="number" required>
                </div>
            `;
        } else if (calcId === 'hex') {
            html += `
                <div class="form-group">
                    <label>Decimal Number:</label>
                    <input type="number" id="number" required>
                </div>
            `;
        } else if (calcId === 'prime_check') {
            html += `
                <div class="form-group">
                    <label>Number:</label>
                    <input type="number" id="number" required>
                </div>
            `;
        } else if (calcId === 'fibonacci') {
            html += `
                <div class="form-group">
                    <label>Number of Terms:</label>
                    <input type="number" id="n" min="1" max="50" required>
                </div>
            `;
        } else if (calcId === 'random_number') {
            html += `
                <div class="form-group">
                    <label>Minimum:</label>
                    <input type="number" id="min" value="1" required>
                </div>
                <div class="form-group">
                    <label>Maximum:</label>
                    <input type="number" id="max" value="100" required>
                </div>
            `;
        } else if (calcId === 'date_add') {
            html += `
                <div class="form-group">
                    <label>Start Date:</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label>Days to Add:</label>
                    <input type="number" id="days" required>
                </div>
            `;
        } else if (calcId === 'weekday') {
            html += `
                <div class="form-group">
                    <label>Date:</label>
                    <input type="date" id="date" required>
                </div>
            `;
        } else if (calcId === 'leap_year') {
            html += `
                <div class="form-group">
                    <label>Year:</label>
                    <input type="number" id="year" required>
                </div>
            `;
        } else if (calcId === 'median') {
            html += `
                <div class="form-group">
                    <label>Numbers (comma-separated):</label>
                    <input type="text" id="numbers" required>
                </div>
            `;
        } else if (calcId === 'mode') {
            html += `
                <div class="form-group">
                    <label>Numbers (comma-separated):</label>
                    <input type="text" id="numbers" required>
                </div>
            `;
        } else if (calcId === 'standard_deviation') {
            html += `
                <div class="form-group">
                    <label>Numbers (comma-separated):</label>
                    <input type="text" id="numbers" required>
                </div>
            `;
        } else if (calcId === 'variance') {
            html += `
                <div class="form-group">
                    <label>Numbers (comma-separated):</label>
                    <input type="text" id="numbers" required>
                </div>
            `;
        } else if (calcId === 'volume_cube') {
            html += `
                <div class="form-group">
                    <label>Side Length:</label>
                    <input type="number" id="side" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'volume_cylinder') {
            html += `
                <div class="form-group">
                    <label>Radius:</label>
                    <input type="number" id="radius" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height:</label>
                    <input type="number" id="height" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'area_trapezoid') {
            html += `
                <div class="form-group">
                    <label>Base 1:</label>
                    <input type="number" id="base1" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Base 2:</label>
                    <input type="number" id="base2" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height:</label>
                    <input type="number" id="height" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'quadratic') {
            html += `
                <div class="form-group">
                    <label>Coefficient a:</label>
                    <input type="number" id="a" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Coefficient b:</label>
                    <input type="number" id="b" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Coefficient c:</label>
                    <input type="number" id="c" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'permutation') {
            html += `
                <div class="form-group">
                    <label>Total Items (n):</label>
                    <input type="number" id="n" required>
                </div>
                <div class="form-group">
                    <label>Items to Choose (r):</label>
                    <input type="number" id="r" required>
                </div>
            `;
        } else if (calcId === 'combination') {
            html += `
                <div class="form-group">
                    <label>Total Items (n):</label>
                    <input type="number" id="n" required>
                </div>
                <div class="form-group">
                    <label>Items to Choose (r):</label>
                    <input type="number" id="r" required>
                </div>
            `;
        } else if (calcId === 'distance') {
            html += `
                <div class="form-group">
                    <label>Point 1 - X coordinate:</label>
                    <input type="number" id="x1" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 1 - Y coordinate:</label>
                    <input type="number" id="y1" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 2 - X coordinate:</label>
                    <input type="number" id="x2" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 2 - Y coordinate:</label>
                    <input type="number" id="y2" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'slope') {
            html += `
                <div class="form-group">
                    <label>Point 1 - X coordinate:</label>
                    <input type="number" id="x1" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 1 - Y coordinate:</label>
                    <input type="number" id="y1" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 2 - X coordinate:</label>
                    <input type="number" id="x2" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Point 2 - Y coordinate:</label>
                    <input type="number" id="y2" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'percentage_change') {
            html += `
                <div class="form-group">
                    <label>Old Value:</label>
                    <input type="number" id="old" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>New Value:</label>
                    <input type="number" id="new" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'percentage_of') {
            html += `
                <div class="form-group">
                    <label>Value:</label>
                    <input type="number" id="value" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Percentage:</label>
                    <input type="number" id="percent" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'mortgage') {
            html += `
                <div class="form-group">
                    <label>Loan Amount ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Loan Term (months):</label>
                    <input type="number" id="months" required>
                </div>
            `;
        } else if (calcId === 'investment_return') {
            html += `
                <div class="form-group">
                    <label>Principal ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Annual Return Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time (years):</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'acceleration') {
            html += `
                <div class="form-group">
                    <label>Initial Velocity (m/s):</label>
                    <input type="number" id="initial_velocity" step="0.01" value="0" required>
                </div>
                <div class="form-group">
                    <label>Final Velocity (m/s):</label>
                    <input type="number" id="final_velocity" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time (seconds):</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'age_difference') {
            html += `
                <div class="form-group">
                    <label>First Date:</label>
                    <input type="date" id="date1" required>
                </div>
                <div class="form-group">
                    <label>Second Date:</label>
                    <input type="date" id="date2" required>
                </div>
            `;
        } else if (calcId === 'octal') {
            html += `
                <div class="form-group">
                    <label>Decimal Number:</label>
                    <input type="number" id="number" required>
                </div>
            `;
        } else if (calcId === 'density') {
            html += `
                <div class="form-group">
                    <label>Mass (kg):</label>
                    <input type="number" id="mass" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Volume (m¬≥):</label>
                    <input type="number" id="volume" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'momentum') {
            html += `
                <div class="form-group">
                    <label>Mass (kg):</label>
                    <input type="number" id="mass" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Velocity (m/s):</label>
                    <input type="number" id="velocity" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'potential_energy') {
            html += `
                <div class="form-group">
                    <label>Mass (kg):</label>
                    <input type="number" id="mass" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height (m):</label>
                    <input type="number" id="height" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'power_physics') {
            html += `
                <div class="form-group">
                    <label>Work (J):</label>
                    <input type="number" id="work" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Time (s):</label>
                    <input type="number" id="time" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'work') {
            html += `
                <div class="form-group">
                    <label>Force (N):</label>
                    <input type="number" id="force" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Distance (m):</label>
                    <input type="number" id="distance" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'pressure_physics') {
            html += `
                <div class="form-group">
                    <label>Force (N):</label>
                    <input type="number" id="force" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Area (m¬≤):</label>
                    <input type="number" id="area" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'grade') {
            html += `
                <div class="form-group">
                    <label>Score Earned:</label>
                    <input type="number" id="score" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Total Points:</label>
                    <input type="number" id="total" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'test_score') {
            html += `
                <div class="form-group">
                    <label>Correct Answers:</label>
                    <input type="number" id="correct" required>
                </div>
                <div class="form-group">
                    <label>Total Questions:</label>
                    <input type="number" id="total" required>
                </div>
            `;
        } else if (calcId === 'final_grade') {
            html += `
                <div class="form-group">
                    <label>Current Grade (%):</label>
                    <input type="number" id="current_grade" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Desired Grade (%):</label>
                    <input type="number" id="desired_grade" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Final Exam Weight (%):</label>
                    <input type="number" id="final_weight" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'cgpa') {
            html += `
                <div class="form-group">
                    <label>GPAs (comma-separated):</label>
                    <input type="text" id="grades" placeholder="3.5, 3.8, 4.0" required>
                </div>
            `;
        } else if (calcId === 'protein_needs') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Activity Level:</label>
                    <select id="activity" required>
                        <option value="sedentary">Sedentary</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="active">Active</option>
                        <option value="athlete">Athlete</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'carbs_needs') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Activity Level:</label>
                    <select id="activity" required>
                        <option value="sedentary">Sedentary</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="active">Active</option>
                        <option value="athlete">Athlete</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'fiber_needs') {
            html += `
                <div class="form-group">
                    <label>Age:</label>
                    <input type="number" id="age" required>
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'sleep_hours') {
            html += `
                <div class="form-group">
                    <label>Bedtime:</label>
                    <input type="time" id="bedtime" required>
                </div>
                <div class="form-group">
                    <label>Wake Time:</label>
                    <input type="time" id="waketime" required>
                </div>
            `;
        } else if (calcId === 'next_birthday') {
            html += `
                <div class="form-group">
                    <label>Date of Birth:</label>
                    <input type="date" id="dob" required>
                </div>
            `;
        } else if (calcId === 'countdown') {
            html += `
                <div class="form-group">
                    <label>Target Date:</label>
                    <input type="date" id="date" required>
                </div>
            `;
        } else if (calcId === 'work_days') {
            html += `
                <div class="form-group">
                    <label>Start Date:</label>
                    <input type="date" id="date1" required>
                </div>
                <div class="form-group">
                    <label>End Date:</label>
                    <input type="date" id="date2" required>
                </div>
            `;
        } else if (calcId === 'car_loan') {
            html += `
                <div class="form-group">
                    <label>Loan Amount ($):</label>
                    <input type="number" id="principal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Loan Term (months):</label>
                    <input type="number" id="months" required>
                </div>
            `;
        } else if (calcId === 'fuel_cost') {
            html += `
                <div class="form-group">
                    <label>Distance (miles):</label>
                    <input type="number" id="distance" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>MPG:</label>
                    <input type="number" id="mpg" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Price per Gallon ($):</label>
                    <input type="number" id="price" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'electricity_cost') {
            html += `
                <div class="form-group">
                    <label>Power (Watts):</label>
                    <input type="number" id="watts" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Hours Used:</label>
                    <input type="number" id="hours" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Rate ($/kWh):</label>
                    <input type="number" id="rate" step="0.01" value="0.12" required>
                </div>
            `;
        } else if (calcId === 'tile_needed') {
            html += `
                <div class="form-group">
                    <label>Room Length (ft):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Room Width (ft):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Tile Size (ft):</label>
                    <input type="number" id="tile_size" step="0.01" value="1" required>
                </div>
            `;
        } else if (calcId === 'flooring') {
            html += `
                <div class="form-group">
                    <label>Length (ft):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width (ft):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'fence') {
            html += `
                <div class="form-group">
                    <label>Length (ft):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width (ft):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'concrete') {
            html += `
                <div class="form-group">
                    <label>Length (ft):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width (ft):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Depth (inches):</label>
                    <input type="number" id="depth" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'roofing') {
            html += `
                <div class="form-group">
                    <label>Length (ft):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width (ft):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Roof Pitch (optional):</label>
                    <input type="number" id="pitch" step="0.01" value="0">
                </div>
            `;
        } else if (calcId === 'recipe_scaler') {
            html += `
                <div class="form-group">
                    <label>Original Servings:</label>
                    <input type="number" id="original_servings" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Desired Servings:</label>
                    <input type="number" id="desired_servings" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'oven_temp') {
            html += `
                <div class="form-group">
                    <label>Temperature:</label>
                    <input type="number" id="temp" step="1" required>
                </div>
                <div class="form-group">
                    <label>From:</label>
                    <select id="from" required>
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="celsius">Celsius</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>To:</label>
                    <select id="to" required>
                        <option value="fahrenheit">Fahrenheit</option>
                        <option value="celsius">Celsius</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'cooking_time') {
            html += `
                <div class="form-group">
                    <label>Weight (lbs or kg):</label>
                    <input type="number" id="weight" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Minutes per Unit:</label>
                    <input type="number" id="time_per_unit" step="1" value="20" required>
                </div>
            `;
        } else if (calcId === 'paint_needed') {
            html += `
                <div class="form-group">
                    <label>Length (feet):</label>
                    <input type="number" id="length" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Width (feet):</label>
                    <input type="number" id="width" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height (feet, optional):</label>
                    <input type="number" id="height" step="0.01">
                </div>
                <div class="form-group">
                    <label>Number of Coats:</label>
                    <input type="number" id="coats" value="1" required>
                </div>
                <div class="form-group">
                    <label>Coverage per gallon (sq ft):</label>
                    <input type="number" id="coverage" value="350" required>
                </div>
            `;
        } else if (calcId === 'savings_goal') {
            html += `
                <div class="form-group">
                    <label>Savings Goal ($):</label>
                    <input type="number" id="goal" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" value="0">
                </div>
                <div class="form-group">
                    <label>Time (months):</label>
                    <input type="number" id="months" required>
                </div>
            `;
        } else if (calcId === 'retirement') {
            html += `
                <div class="form-group">
                    <label>Current Age:</label>
                    <input type="number" id="current_age" required>
                </div>
                <div class="form-group">
                    <label>Retirement Age:</label>
                    <input type="number" id="retire_age" required>
                </div>
                <div class="form-group">
                    <label>Current Savings ($):</label>
                    <input type="number" id="current_savings" step="0.01" value="0">
                </div>
                <div class="form-group">
                    <label>Monthly Contribution ($):</label>
                    <input type="number" id="monthly_contribution" step="0.01" value="0">
                </div>
                <div class="form-group">
                    <label>Annual Return Rate (%):</label>
                    <input type="number" id="rate" step="0.01" value="5">
                </div>
            `;
        } else if (calcId === 'currency_converter') {
            html += `
                <div class="form-group">
                    <label>Amount:</label>
                    <input type="number" id="amount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>From Rate (to USD):</label>
                    <input type="number" id="from_rate" step="0.0001" value="1" required>
                </div>
                <div class="form-group">
                    <label>To Rate (from USD):</label>
                    <input type="number" id="to_rate" step="0.0001" value="1" required>
                </div>
            `;
        } else if (calcId === 'roman_numeral') {
            html += `
                <div class="form-group">
                    <label>Number (1-3999):</label>
                    <input type="number" id="number" min="1" max="3999" required>
                </div>
            `;
        } else if (calcId === 'alcohol_units') {
            html += `
                <div class="form-group">
                    <label>Volume (ml):</label>
                    <input type="number" id="volume" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>ABV (%):</label>
                    <input type="number" id="abv" step="0.1" required>
                </div>
            `;
        } else if (calcId === 'body_fat') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Waist (cm):</label>
                    <input type="number" id="waist" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'ideal_weight') {
            html += `
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'calories_burned') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Duration (minutes):</label>
                    <input type="number" id="duration" step="1" required>
                </div>
                <div class="form-group">
                    <label>Activity Level:</label>
                    <select id="activity" required>
                        <option value="light">Light</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="vigorous">Vigorous</option>
                    </select>
                </div>
            `;
        } else if (calcId === 'water_intake') {
            html += `
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Activity Hours:</label>
                    <input type="number" id="activity" step="0.1" value="0">
                </div>
            `;
        } else if (calcId === 'heart_rate') {
            html += `
                <div class="form-group">
                    <label>Age:</label>
                    <input type="number" id="age" required>
                </div>
            `;
        } else if (calcId === 'mortgage') {
            html += `
                <div class="form-group">
                    <label>Home Price ($):</label>
                    <input type="number" id="price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Down Payment ($):</label>
                    <input type="number" id="down" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Interest Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Loan Term (years):</label>
                    <input type="number" id="years" required>
                </div>
            `;

        } else if (calcId === 'fuel_economy') {
            html += `
                <div class="form-group">
                    <label>Distance (miles):</label>
                    <input type="number" id="distance" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Fuel Used (gallons):</label>
                    <input type="number" id="fuel" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'discount') {
            html += `
                <div class="form-group">
                    <label>Original Price ($):</label>
                    <input type="number" id="price" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Discount (%):</label>
                    <input type="number" id="discount" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'tax') {
            html += `
                <div class="form-group">
                    <label>Amount ($):</label>
                    <input type="number" id="amount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Tax Rate (%):</label>
                    <input type="number" id="rate" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'grade') {
            html += `
                <div class="form-group">
                    <label>Points Earned:</label>
                    <input type="number" id="earned" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Total Points:</label>
                    <input type="number" id="total" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'retirement') {
            html += `
                <div class="form-group">
                    <label>Current Age:</label>
                    <input type="number" id="age" required>
                </div>
                <div class="form-group">
                    <label>Retirement Age:</label>
                    <input type="number" id="retire_age" required>
                </div>
                <div class="form-group">
                    <label>Monthly Savings ($):</label>
                    <input type="number" id="monthly" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Annual Return (%):</label>
                    <input type="number" id="return" step="0.01" value="7" required>
                </div>
            `;
        } else if (calcId === 'investment') {
            html += `
                <div class="form-group">
                    <label>Initial Investment ($):</label>
                    <input type="number" id="initial" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Monthly Contribution ($):</label>
                    <input type="number" id="monthly" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Annual Return (%):</label>
                    <input type="number" id="return" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Years:</label>
                    <input type="number" id="years" required>
                </div>
            `;
        } else if (calcId === 'body_fat') {
            html += `
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Age:</label>
                    <input type="number" id="age" required>
                </div>
                <div class="form-group">
                    <label>Weight (kg):</label>
                    <input type="number" id="weight" step="0.1" required>
                </div>
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
            `;
        } else if (calcId === 'ideal_weight') {
            html += `
                <div class="form-group">
                    <label>Gender:</label>
                    <select id="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Height (cm):</label>
                    <input type="number" id="height" step="0.1" required>
                </div>
            `;
        } else if (calcId === 'pregnancy') {
            html += `
                <div class="form-group">
                    <label>Last Menstrual Period:</label>
                    <input type="date" id="lmp" required>
                </div>
            `;
        } else if (calcId === 'area_square') {
            html += `
                <div class="form-group">
                    <label>Side Length:</label>
                    <input type="number" id="side" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'volume_cube') {
            html += `
                <div class="form-group">
                    <label>Side Length:</label>
                    <input type="number" id="side" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'volume_cylinder') {
            html += `
                <div class="form-group">
                    <label>Radius:</label>
                    <input type="number" id="radius" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Height:</label>
                    <input type="number" id="height" step="0.01" required>
                </div>
            `;
        } else if (calcId === 'quadratic') {
            html += `
                <div class="form-group">
                    <label>a (coefficient of x¬≤):</label>
                    <input type="number" id="a" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>b (coefficient of x):</label>
                    <input type="number" id="b" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>c (constant):</label>
                    <input type="number" id="c" step="0.01" required>
                </div>
            `;
        } else {
            html += `
                <div class="form-group">
                    <div style="text-align:center; padding:40px; background:linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius:15px; border:2px dashed #667eea;">
                        <h3 style="color:#667eea; margin-bottom:15px;">üöß Calculator Coming Soon!</h3>
                        <p style="color:#666; margin-bottom:20px;">This calculator is being developed and will be available soon.</p>
                        <p style="color:#888; font-size:0.9em;">We're constantly adding new calculators to serve you better!</p>
                    </div>
                </div>
            `;
        }

        html += `
            <div style="margin-top:20px;">
                <button type="submit" class="submit-button">Calculate</button>
            </div>
            </form>
            <div class="result" id="result" aria-live="polite"></div>
        `;

        container.innerHTML = html;

        const dynamicForm = document.getElementById('dynamicForm');
        if (dynamicForm) {
            dynamicForm.addEventListener('submit', function(e) {
                e.preventDefault();
                calculate(calcId);
            });
        }
    }

    function calculate(calcId) {
        const form = document.getElementById('dynamicForm');
        if (!form) return;
        const inputs = form.querySelectorAll('input, select');
        const data = {};

        inputs.forEach(input => {
            if (input.id) data[input.id] = input.value;
        });

        const resultDiv = document.getElementById('result');
        if (resultDiv) resultDiv.textContent = 'Calculating...';

        fetch('/calculate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ calc_id: calcId, data: data })
        })
        .then(response => {
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            return response.json();
        })
        .then(json => {
            if (resultDiv) {
                resultDiv.textContent = json.result;
                resultDiv.style.display = 'block';
                resultDiv.classList.add('show');
            }
        })
        .catch(err => {
            if (resultDiv) {
                resultDiv.textContent = 'Error: ' + err.message;
                resultDiv.style.display = 'block';
                resultDiv.classList.add('show');
            }
            console.error('Calculate error:', err);
        });
    }

    function escapeHtml(unsafe) {
        if (unsafe === undefined || unsafe === null) return '';
        return String(unsafe)
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    // Initialize
    filterCalculators('', 'all');
// Feedback popup JS
document.getElementById("feedbackBtn").onclick = () => {
    document.getElementById("feedbackPopup").style.display = "flex";
};

document.querySelector(".close-popup").onclick = () => {
    document.getElementById("feedbackPopup").style.display = "none";
};

window.onclick = (e) => {
    if (e.target.id === "feedbackPopup") {
        document.getElementById("feedbackPopup").style.display = "none";
    }
};
</script>
<div id="feedbackPopup" class="feedback-popup">
    <div class="popup-content">
        <span class="close-popup">&times;</span>
        <h2>Send Feedback</h2>

        <form action="https://formsubmit.co/himeshmishra109@gmail.com" method="POST">
            <input type="hidden" name="_captcha" value="false">
            <input type="hidden" name="_subject" value="New Feedback">

            <div class="form-group">
                <label>Name</label>
                <input type="text" name="name" required>
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" required>
            </div>

            <div class="form-group">
                <label>Message</label>
                <textarea name="message" required></textarea>
            </div>

            <button type="submit" class="submit-button">Send</button>
        </form>
    </div>
</div>
</body>
</html>
